package vista;

import java.awt.Container;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JPasswordField;
import javax.swing.JTextField;

import entidades.Profesor;
import logica.ProfesorLogica;

public class FrameLoginProfesor extends JFrame {

	JTextField textoUsuario;
	JPasswordField textoContrasena;

	public FrameLoginProfesor() {
		super("Login Profesor");
		this.setSize(800, 250);
		this.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
		Container contenedor = getContentPane();

		GridLayout glt = new GridLayout(3, 1);
		contenedor.setLayout(glt);

		// crear panel con JPanel
		JPanel panelUsuario = new JPanel();
		// crear etiqueta con JLabel
		JLabel usuario = new JLabel();
		usuario.setText("Email");
		panelUsuario.add(usuario);
		// crear area de texto con JTextField
		textoUsuario = new JTextField(15);
		panelUsuario.add(textoUsuario);
		contenedor.add(panelUsuario);

		// crear panel con JPanel
		JPanel panelContrasena = new JPanel();
		// crear etiqueta con JLabel
		JLabel contrasena = new JLabel();
		contrasena.setText("Contrasena");
		panelContrasena.add(contrasena);
		// crear area de texto con JTextField
		textoContrasena = new JPasswordField(15);
		panelContrasena.add(textoContrasena);
		contenedor.add(panelContrasena);

		// crear boton de login
		JButton botonLogin = new JButton("Acceder");
		botonLogin.addActionListener(new EventoBotonLogin());
		contenedor.add(botonLogin);
	}

	public class EventoBotonLogin implements ActionListener {

		public void actionPerformed(ActionEvent arg0) {
			//obtener los profesores de la bbdd
			/*ArrayList<Profesor> arrayProfesores = ProfesorLogica.buscarTodosProfesores();
			for (int i = 0; i < arrayProfesores.size(); i++) {
				// obtener los atributos
				Profesor profesores = arrayProfesores.get(i);
				String usuarioProfe = profesores.getEmail();
				String contrasenaProfe = profesores.getDNI();
				
				if(usuarioProfe.equals(textoUsuario.getText())) {
					if(contrasenaProfe.equals(textoContrasena.getText())) {
						//frame mostrar tabla alumnos y boton de calificar alumno en tabla
						JFrame FrameMostrarAlumnos = new FrameMostrarAlumnosProfesor();
						FrameMostrarAlumnos.setVisible(true);
					}else {
						JOptionPane.showMessageDialog(null, "Error, la contraseña no es correcta");
					}
				}else {
					JOptionPane.showMessageDialog(null, "Error, el email no es correcto");
				}
			}*/
			//NUEVO:
			boolean loginCorrecto = ProfesorLogica.loginProfesor(textoUsuario.getText(), textoContrasena.getText());
			if(loginCorrecto) {
				//se pasa el usuario para que en las pantallas siguientes se muestre solo información del profesor que ha hecho login
				Profesor profesor = ProfesorLogica.buscarProfesor(textoUsuario.getText());
				JFrame FrameMostrarAlumnos = new FrameMostrarAlumnosProfesor(profesor);
				FrameMostrarAlumnos.setVisible(true);
			}else {
				JOptionPane.showMessageDialog(null, "Error, el usuario o contraseña no son correctos");
			}
		}
	}

}
